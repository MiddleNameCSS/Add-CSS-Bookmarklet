// http://rocktronica.github.com/Add-CSS-Bookmarklet/
(function(){function d(a){window.addCss=function(){var a=window.jQuery,b={},c=a(window);if(document.getElementById("txtAddCss")){a("#txtAddCss").toggle();return false}var d=function(){try{return"localStorage"in window&&window["localStorage"]!==null}catch(a){return false}}();var e=a("<div />").css({position:"fixed",bottom:"10px",right:"10px","z-index":"1000"}).appendTo(a("body"));var f=a("<style id='styleAddCss'>/**/</style>").appendTo(a("body")),g=true,h=500;var i=a("<style type='text/css'> 				#txtAddCss{ resize:both; display:block; background-color:#111; backgrond: #000; background:rgba(0,0,0,.9); color:#fff; border:1px solid #000; outline:none; width:400px; height:200px; font:13px/18px 'Courier New', Courier, 'Lucida Sans Typewriter', 'Lucida Typewriter', monospace; padding: 10px; overflow: auto; resize: none; } 				#spAddCssHandle { border-width: 8px; border-style: solid; border-color: rgb(255, 255, 255) transparent transparent rgb(255, 255, 255); position: absolute; top: 0px; left: 0px; opacity: 0.1; cursor: nw-resize; } 			</style>").appendTo(e);var j=a("<textarea id='txtAddCss' spellcheck='false' />").appendTo(e).focus();var k=a("<span id='spAddCssHandle' />").appendTo(e);if(document.getElementById("styleAddCss").innerHTML!=="/**/"){g=false;h=1e3}(function(){function c(a){if(a.selectionStart){return a.selectionStart}else if(document.selection){a.focus();var b=document.selection.createRange();if(b==null){return 0}var c=a.createTextRange(),d=c.duplicate();c.moveToBookmark(b.getBookmark());d.setEndPoint("EndToStart",c);return d.text.length}return 0}function e(a,b){if(a.setSelectionRange){a.setSelectionRange(b,b)}else if(input.createTextRange){var c=a.createTextRange();c.collapse(true);c.moveEnd("character",b);c.moveStart("character",b);c.select()}}j.bind("keyup change",function(){b.keyup=b.keyup||setTimeout(function(){var c=j.val();if(g){f.html(c)}else{f.replaceWith("<style id='styleAddCss'>"+c+"</style>");f=a(document.getElementById("styleAddCss"))}if(d){localStorage.addCss=c}b.keyup=undefined},h)}).bind("keydown",function(a){if(a.which===27){j.toggle()}else if(a.which===9){var b=j.val(),d=c(j[0]);j.val(b.substr(0,d)+"	"+b.substr(d));d++;e(j[0],d);return false}})})();if(d){if(localStorage.addCss){j.val(localStorage.addCss).change()}if(localStorage.addCssCss){j.css(a.parseJSON(localStorage.addCssCss))}}(function(){function g(){var a=40;var d={width:c.width(),height:c.height()};var e={width:j.width(),height:j.height()};if(d.width<e.width+a){var g=d.width-a;j.css("width",g);f.start.width=g}if(d.height<e.height+a){var h=d.height-a;j.css("height",h);f.start.height=h}b.windowResize=undefined}var e={start:{},diff:{}},f={start:{width:j.width(),height:j.height()},end:{width:undefined,height:undefined}};var h={startDrag:function(b){e.start={x:b.clientX||b.pageX,y:b.clientY||b.pageY};a(document).on("mousemove",h.onMouseMove);a(document).on("mouseup",h.endDrag);a(document).on("keypress",h.endDrag);return false},onMouseMove:function(a){e.diff.x=e.start.x-(a.clientX||a.pageX);e.diff.y=e.start.y-(a.clientY||a.pageY);f.end.width=f.start.width+e.diff.x;f.end.height=f.start.height+e.diff.y;j.css(f.end)},endDrag:function(b){if(d){localStorage.addCssCss=JSON.stringify(f.end)}e.diff={x:0,y:0},f={start:{width:j.width(),height:j.height()},end:{width:undefined,height:undefined}};a(document).off("mousemove",h.onMouseMove);a(document).off("mouseup",h.endDrag);a(document).off("keypress",h.endDrag);g();return false}};k.on("mousedown",h.startDrag);c.on("resize",function(){b.windowResize=b.windowResize||setTimeout(g,10)}).resize()})()};window.addCss()}var a="1.7";if(window.jQuery===undefined||window.jQuery.fn.jquery<a){var b=false;var c=document.createElement("script");c.src="http://ajax.googleapis.com/ajax/libs/jquery/"+a+"/jquery.min.js";c.onload=c.onreadystatechange=function(){if(!b&&(!this.readyState||this.readyState=="loaded"||this.readyState=="complete")){b=true;d(jQuery)}};document.getElementsByTagName("head")[0].appendChild(c)}else{d(jQuery)}})()